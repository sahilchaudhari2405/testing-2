version: '3.8'

services:
  client:
    build:
      context: ./client
      dockerfile: Dockerfile
    ports:
      - "80:80"
    environment:
      - REACT_APP_API_URL=http://gateway:4000
    networks:
      - app-network

  gateway:
    build:
      context: ./gateways  
      dockerfile: Dockerfile
    ports:
      - "4000:4000"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    depends_on:
      - products
      - sales-advancepay
      - sales-cart
      - sales-ongoing
      - sales-order
      - user-admin
      - user-auth
      - user-setting
      - user-users
    networks:
      - app-network

  products:
    build:
      context: ./products
      dockerfile: Dockerfile
    ports:
      - "3001:3001"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  ## ðŸ›’ SALES SERVICES (Renamed)
  sales-advancepay:
    build:
      context: ./sales/AdvancePay  
      dockerfile: Dockerfile
    ports:
      - "4001:4001"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  sales-cart:
    build:
      context: ./sales/cart  
      dockerfile: Dockerfile
    ports:
      - "4002:4002"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  sales-ongoing:
    build:
      context: ./sales/onGoing  
      dockerfile: Dockerfile
    ports:
      - "4003:4003"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  sales-order:
    build:
      context: ./sales/order  
      dockerfile: Dockerfile
    ports:
      - "4004:4004"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  ## ðŸ‘¤ USER SERVICES (Renamed)
  user-admin:
    build:
      context: ./user/admin  
      dockerfile: Dockerfile
    ports:
      - "5001:5001"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  user-auth:
    build:
      context: ./user/Auth  
      dockerfile: Dockerfile
    ports:
      - "5002:5002"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  user-setting:
    build:
      context: ./user/setting  
      dockerfile: Dockerfile
    ports:
      - "5003:5003"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

  user-users:
    build:
      context: ./user/users  
      dockerfile: Dockerfile
    ports:
      - "5004:5004"
    environment:
      - CORS_ALLOWED_ORIGINS=13.233.134.211
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
